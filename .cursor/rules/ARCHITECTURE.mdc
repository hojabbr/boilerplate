---
alwaysApply: true
name: enterpriseâ€‘riltâ€‘stackâ€‘partâ€‘1
description: "Partâ€¯1 of the architecture definition for a fully localized Laravelâ€¯12 + Inertiaâ€¯2.3.7 + Reactâ€¯19.2.0 application with Scout/Meilisearch, mcamara/localization, SOLID/CLEAN/DRY design, Filament admin, SSR/SEO optimization, and backend conventions. Optimized for AI reasoning and code generation."
license: MIT
metadata:
  author: yourâ€‘team
---

# ğŸ§  Architecture â€” Partâ€¯1: Backend Core (Laravelâ€¯12)

## ğŸš€ **1. Core Architectural Vision**

This backend architecture is designed for:

- **Scalable, maintainable domains** with clear separation of concerns
- **SOLID / CLEAN / DRY** principles enforced through structure
- **Inertia SSR** delivering SEOâ€‘ready server renders
- **Localization** with route prefixes and internal content translation
- **Search** via **Laravel Scout + Meilisearch** for realâ€‘time search features
- **Admin UI** via Filament
- **Realâ€‘time** updates via broadcast

This structure enables multiple teams to work in parallel while minimizing coupling and maximizing reuse.

---

## ğŸ“ **2. Backend Folder & Domain Structure**

app/
â”œâ”€â”€ Actions/                    # Business logic operations (use cases)
â”œâ”€â”€ Data/DTOs/                  # Typed data transfer objects
â”œâ”€â”€ Http/
â”‚   â”œâ”€â”€ Controllers/
â”‚   â”‚   â”œâ”€â”€ Auth/              # Authentication & Fortify overrides
â”‚   â”‚   â”œâ”€â”€ Web/               # Inertia controllers
â”‚   â”‚   â””â”€â”€ Api/               # API controllers (if needed)
â”‚   â”œâ”€â”€ Middleware/            # Locale detection, auth, role guards
â”‚   â””â”€â”€ Requests/              # FormRequests (validation)
â”œâ”€â”€ Jobs/                      # Queued jobs (e.g., indexing, emails)
â”œâ”€â”€ Models/                    # Eloquent models + relations
â”œâ”€â”€ Policies/                  # Authorization policies
â”œâ”€â”€ Notifications/             # Notification definitions
â”œâ”€â”€ Providers/                 # Service providers (bindings, schedules)
â”œâ”€â”€ Queries/                   # Spatie Query Builder query objects
â”œâ”€â”€ Search/                    # Scout/Meilisearch indexing configuration
â”œâ”€â”€ Services/                  # Shared domain services (SearchSync, Pricing)
â””â”€â”€ Rules/                     # Custom validation rules

### ğŸ“Œ Domain Concepts

- **Controllers** act as adapters translating HTTP â†’ Actions.  
- **Actions** encapsulate single business flows, improving testability.  
- **DTOs** unify inputs/outputs between controllers and services.  
- **Policies** secure resource access.  
- **Queries** centralize query logic (filtering, sorting, relations).  
- **Services** manage crossâ€‘cutting concerns (search syncing, jobs, reports).

---

## ğŸŒ **3. Localization (Global Backend Strategy)**

### ğŸ” Routing & Middleware

Use **mcamara/laravelâ€‘localization** to prefix all routes with locale identifiers.

**bootstrap/app.php:** Register middleware aliases: `localize` (LaravelLocalizationRoutes), `localizationRedirect` (LaravelLocalizationRedirectFilter), `localeSessionRedirect` (LocaleSessionRedirect), `localeCookieRedirect` (LocaleCookieRedirect), `localeViewPath` (LaravelLocalizationViewPath), `setLocalizedFortifyRedirects` (SetLocalizedFortifyRedirects). Prepend `LocaleSessionRedirect` to the web stack so `/` redirects to the preferred locale.

**routes/web.php:** Use a route group with `prefix => LaravelLocalization::setLocale()` and middleware `localeSessionRedirect`, `localizationRedirect`, `localeViewPath`, `setLocalizedFortifyRedirects`. The package sets app locale (and translator/regional) when the prefix is evaluated per request. Call `Fortify::ignoreRoutes()` in FortifyServiceProvider::register(), then require Fortify routes inside the locale group so auth is under `/{locale}/login`, etc. SetLocalizedFortifyRedirects sets Fortify redirect config from `app()->getLocale()` so login/logout stay in the current locale.

**config/laravellocalization urlsIgnored:** Only `/skipped` and `/admin`, `/admin/*`. Do not ignore login/register so they stay under the locale prefix.

- Language is detected from URL, session, or browser headers.
- **middleware layers** ensure locale persistence and correct redirection.

### ğŸ“š Multiâ€‘Locale Content

- Leverage Laravelâ€™s translation system for static strings (JSON or PHP).  
- For dynamic content (titles/descriptions stored in DB), use JSON columns or translation tables (rowâ€‘perâ€‘language pattern).  [oai_citation:1â€¡Reddit](https://www.reddit.com/r/laravel/comments/1j3613p?utm_source=chatgpt.com)

### ğŸª Best Practices

- Use PHP arrays for structured groups; use JSON for UI labels/shared strings.  [oai_citation:2â€¡Reddit](https://www.reddit.com/r/laravel/comments/1q09zk6/which_translation_style_do_you_use/?utm_source=chatgpt.com)  
- Combine with Carbon locale settings for date, number, currency formatting.  [oai_citation:3â€¡Phrase](https://phrase.com/blog/posts/laravel-i18n-frontend-best-practices/?utm_source=chatgpt.com)

---

## ğŸ” **4. Full Search â€” Scout + Meilisearch**

Use **Laravel Scout** configured to use **Meilisearch** for fullâ€‘text, faceted, typoâ€‘tolerant search.  [oai_citation:4â€¡Laravel](https://laravel.com/docs/12.x/scout?utm_source=chatgpt.com)

### ğŸš€ Setup

- Install Meilisearch driver and packages.  
- Set environment variables in `.env`:  

SCOUT_DRIVER=meilisearch
MEILISEARCH_HOST=http://127.0.0.1:7700
MEILISEARCH_KEY=masterKey

### ğŸ“¦ Search Integration

- Mark searchable models with Scout trait.
- Implement `toSearchableArray()` to tailor indexed data.
- Use filters & synonyms to support multilingual search relevance.

### ğŸ“Œ Tips

- Always flush and sync after changing searchable fields to avoid stale index states.  [oai_citation:5â€¡Reddit](https://www.reddit.com/r/laravel/comments/1b0271f?utm_source=chatgpt.com)  
- For large datasets, incremental indexing jobs are recommended.

---

## ğŸ‘¤ **5. Authentication & Authorization**

- Use **Laravel Fortify** for credentials, MFA, and session handling.  
- Shared auth props provided to Inertia every request.  
- Define **Policies** per resource to enforce business rules.

---

## ğŸš© **5a. Feature Flags â€” Laravel Pennant**

Use **Laravel Pennant** for all feature flagging: gradual rollouts, A/B tests, and conditional features.

- **Define features** in `app/Features/` (or Pennantâ€™s default location). Use the `Feature` facade and the `@feature` Blade directive (or server-side checks) to gate UI and behavior.
- **Current usage:** Gate registration, two-factor auth, or other Fortify/application features so they can be toggled per environment or audience.
- **Future features:** Any new optional or experimental feature (e.g. new dashboards, beta APIs, UI variants) should be controlled via Pennant. Keep feature definitions in one place and document them in the project README or ARCHITECTURE.
- **Testing:** Use Pennantâ€™s in-memory driver or `Feature::activate()` / `Feature::deactivate()` in tests to assert both on/off states.

---

## ğŸŒ **6. Realâ€‘Time & Background Jobs**

- **Laravel Reverb** for WebSockets and user notifications.  
- Use Events + Listeners for domain events (e.g., user registered, order placed).  
- **Jobs/Queues** handle async tasks (email, search reindexing, analytics).

---

## ğŸ§‘â€ğŸ’¼ **7. Admin Dashboard â€” Filament**

Filament manages administrative UIs, forms, tables, and resource pages.

app/
â””â”€â”€ Filament/
â”œâ”€â”€ Resources/
â”‚   â”œâ”€â”€ UsersResource.php
â”‚   â”œâ”€â”€ RolesResource.php

- Leverage policies & roles for admin access control.
- Extend Filament with custom tools, reports, and charts.

---

## ğŸ“¦ **8. Metadata & SEO Backend Strategy**

- Inject SEO meta (title/description/OG) via Inertia SSR props.  
- Provide **hreflang** alternate links for each locale in head.  
- Generate sitemap & robots via scheduled commands.

---

## ğŸ§ª **9. Testing Backend with Pest + PHPUnit**

**Backend Tests:**

- Unit test services and actions
- Feature test controllers with Inertia payload asserts
- Localization route tests
- Search indexing & result tests
- Policy tests
- Queue job behavior

Example:
```php
test('homepage localized', function () {
    $this->get('/en')->assertInertia(fn($page) => $page->where('locale','en'));
});
```

Scenarios should be contrived to ensure locale fallbacks and error states.

---

ğŸ“Œ Summary & Backend Principles

Objective	Strategy
Separation of concerns	Actions + DTOs + Controllers
Search	MeiliSearch via Scout
Localization	Route prefixes + i18next sync
Realâ€‘Time	Reverb + Echo
Admin	Filament resources
SEO	SSR + meta + sitemap
Testing	Pest + PHPUnit coverage


---

# ğŸ§  Architecture â€” Partâ€¯2: Frontend & UI

## ğŸ“¦ Overview: Frontend Stack

Frontend is built with:

- **React 19.2.0** with **Inertia.js** as the BFF/SSR glue  
- **Shadcn UI** primitives and **Radix** for accessible components  
- **Tailwindâ€¯CSS** + **Tailwindâ€‘Merge** for atomic utility styles  
- **i18next** + **i18nextâ€‘browserâ€‘languagedetector** for UI i18n  
- **Zustand** for UI and client state not provided by backend  
- **Vite** as build tool with SSR capabilities

This setup reflects common modern patterns for Laravel + React with **no separate API** layer, reducing complexity and keeping routing / SSR tightly integrated. ([turn0search7])

---

## ğŸ§© Directory Structure (Frontend)

resources/
â””â”€â”€ js/
â”œâ”€â”€ app.tsx                     # Inertia entry and SSR integration
â”œâ”€â”€ pages/                      # Inertia page components (SSR)
â”œâ”€â”€ layouts/                    # Shared layout components
â”œâ”€â”€ components/                 # Shared reusable components
â”‚   â”œâ”€â”€ ui/                     # Shadcn UI extensions/adapters
â”‚   â”œâ”€â”€ common/                 # Generic, shared UI parts
â”‚   â””â”€â”€ feature/                # Featureâ€‘scoped components
â”œâ”€â”€ i18n/                       # i18next configuration + translation files
â”œâ”€â”€ store/                      # Zustand state modules
â”œâ”€â”€ utils/                      # Helpers (fetch, inertia helpers)
â”œâ”€â”€ types/                      # Shared TS types (backend DTO mirrors)
â””â”€â”€ tests/                      # Frontend tests (Jest/Playwright)

### ğŸƒ UI Principles

- Shadcn UI + Radix for accessible, composable UI primitives.  
- Tailwind CSS for consistent layout & responsive styles.  
- Use **atomic UI systems** with Tailwind variants and `classâ€‘varianceâ€‘authority` for stronglyâ€‘typed style configs.

Shadcn UI drastically accelerates UI scaffolding of consistent design components and props patterns. ([turn0search1])

---

## ğŸŒ Localization (Frontend)

### ğŸ§  i18next Setup

Use **i18next** + **i18nextâ€‘browserâ€‘languagedetector** with React:

- Define supported languages (`en`, `it`, `de`, `es`, `fr`, `ru`, `zh`, `fa`, `ar`, `jp`, `kr`)
- Use lazy loading of translation namespaces per page/feature to optimize bundle size and avoid loading all languages at once. ([turn0search12])
- Sync backend locale with i18next on Inertia SSR props so both ends share current locale context.

Example i18n init:

```ts
import i18n from 'i18next';
import LanguageDetector from 'i18next-browser-languagedetector';
import { initReactI18next } from 'react-i18next';

i18n.use(LanguageDetector)
  .use(initReactI18next)
  .init({
    supportedLngs: [...],
    fallbackLng: 'en',
    detection: { order: ['querystring','cookie','localStorage'] },
    interpolation: { escapeValue: false },
  });
```

export default i18n;

ğŸ”‘ Ensure translation files are namespaced (core, pages, components) for scalability.

âš ï¸ Avoid loading all languages on initial load â€” prefer namespace lazy loads to reduce bundle size and improve performance. (See best practices for i18n). ([turn0search12], [turn0reddit28])

---

ğŸ” Sync Locale with Backend

Pass backend locale to frontend via Inertia shared props:

Inertia::share('locale', app()->getLocale());

Use this to preâ€‘set i18next and adjust UI direction (ltr / rtl) dynamically; e.g., document.documentElement.setAttribute('dir', 'rtl') for Arabic.

---

ğŸ¨ Theme (light / dark / system)

Always use **light / dark / system** appearance for the frontend and all UI:

- Use a single source of truth (e.g. `useAppearance` hook) that supports `light`, `dark`, and `system`. Persist choice in localStorage and a cookie so SSR can align.
- Apply theme to the document root: toggle a `dark` class on `<html>` and set `color-scheme` so Shadcn/Tailwind dark variants and system UI (scrollbars, etc.) match.
- All layouts and components should rely on this theme (no adâ€‘hoc dark mode toggles). Prefer Tailwind `dark:` utilities and Shadcn theme-aware components.
- If using Sonner/Toaster, feed its `theme` prop from the same source (e.g. `useAppearance().resolvedAppearance`) so there is a single source of truth; avoid mixing next-themes and a custom appearance hook.

---

â†”ï¸ RTL and directionâ€‘aware UI

Support RTL (e.g. `ar`, `fa`) consistently:

- Set `document.documentElement.setAttribute('dir', â€¦)` from the active locale (e.g. in Inertia setup). Use a small set of RTL locales (e.g. `ar`, `fa`) and default to `ltr` otherwise.
- **Icons and arrows:** Use direction-aware icons (e.g. chevrons that flip in RTL, or separate â€œnextâ€/â€œpreviousâ€ semantics) so navigation and flows make sense in both directions.
- **Spacing:** Prefer logical properties: use Tailwind `ps-*`/`pe-*` or `start`/`end` (e.g. `ms-2` â†’ `ms-2` for â€œmargin after content in reading directionâ€) so padding and margins respect RTL/LTR. Avoid hard-coded `ml`/`mr` for directional meaning.
- **Refactor:** After adding these rules, refactor existing layouts, nav, and forms to use RTL-friendly spacing and icons so behavior is consistent in all locales.

---

ğŸ§  Global State (Zustand)

Use Zustand for frontend state not derived from backend domain data:

store/
â”œâ”€â”€ ui.ts        # modal, alert state
â”œâ”€â”€ preferences.ts  # theme, locale UI preferences
â”œâ”€â”€ form.ts      # persistent form state outside backend

Example store:

const useUIStore = create((set) => ({
  theme: 'light',
  setTheme: (theme) => set({ theme }),
}));

Zustand avoids mounting multiple contexts and scales well with selectors for optimized reâ€‘rendering.

---

ğŸ“¡ Realtime & Inertia

Inertia 2â€™s SSR and async features allow:
	â€¢	Deferred, lazy props to reduce blocking time on heavy queries
	â€¢	Async navigation looks instant with prefetch + caching
	â€¢	Inertia reduces the need for a traditional API layer, decreasing surface area and overhead. ([turn0search7])

---

ğŸ” SEO & SSR

ğŸ“¢ Inertia SSR
	â€¢	Inertia SSR outputs full HTML with localized <head> tags (title, description, OG).
	â€¢	Meta tags are page scoped and passed in SSR props.
	â€¢	Use Inertia <Head> component per page for SEO.

Example:

<Head title={t('home.title')} meta={[{name:'description', content:t('home.desc')}, ...]} />

âš ï¸ Always include localized hreflang for alternate languages to signal search engines. Ensure sitemap entries include locales.

SSR strategy:
	â€¢	Render content server side to improve search indexing and initial load.
	â€¢	Use HTTP cache headers to improve performance.

---

âš™ï¸ UI Component Categorization

ğŸ“¦ ui/ (Shadcn + Radix)
	â€¢	Button
	â€¢	Form fields
	â€¢	Dropdowns
	â€¢	Modals
	â€¢	Alerts
	â€¢	Navigation

ğŸ“¦ common/
	â€¢	Shared UI used across pages (e.g., card, list, table)

ğŸ“¦ feature/
	â€¢	Feature scoped UI (e.g., product card, user profile widgets)

Design intent: components are isolated by scope and shared where appropriate, minimizing redundancy and maximizing reusability.

---

ğŸ“ˆ Performance & Optimization
	â€¢	Lazy load page props and translation namespaces.
	â€¢	Use SSR + caching for meta/critical resources.
	â€¢	Vite prefetch bundles, route prefetching, and code splitting.
	â€¢	Use optimized image handling and dynamic imports.

---

ğŸ§ª Frontend Testing

ğŸ§© Component Tests
	â€¢	Jest + React Testing Library
	â€¢	Test UI logic, interactions, and localized content.

ğŸ§ª Endâ€‘toâ€‘End Tests
	â€¢	Playwright via Pest plugin for browser flows
	â€¢	Combined with Inertia SSR ensures full coverage.

Example Playwright E2E:

test('localized homepage loads', function () {
  $page = visit('/');
  $page->assertSee('Welcome');
});


---

ğŸ“Œ Summary (Frontend)

Concern	Solution
UI Library	Shadcn + Radix + Tailwind
Theme	Light / dark / system via useAppearance; document root class + color-scheme
Locales	i18next + Inertia shared props
RTL	Dynamic dir; direction-aware icons and logical spacing (start/end, ps/pe)
Global State	Zustand
SEO/SSR	Inertia SSR + Inertia Head metadata
Performance	Prefetch + lazy load
Testing	Jest + Playwright


---

# ğŸ¤– Architecture â€” Partâ€¯3: DevOps, Quality, CI/CD & Releases

## ğŸ“ˆ Continuous Integration & Delivery (CI/CD)

### ğŸš€ GitHub Actions Workflow

Use GitHub Actions as the primary CI/CD engine.  
Define workflows for:  
- **linting & formatting**
- **type checking**
- **unit & feature tests**
- **e2e/browser tests**
- **deployment**
- **semantic release automation**

Example pipeline stages:

.name: CI

on:
pull_request:
push:
branches: [main, release/*]

jobs:
lint:
runs-on: ubuntu-latest
steps:
- checkout
- setup node
- install deps
- run eslint & prettier checks

test:
runs-on: ubuntu-latest
strategy:
matrix:
php-version: [8.2, 8.3]
node-version: [18.x]
steps:
- checkout
- setup php & composer
- setup node & npm
- install backend & frontend deps
- run backend tests (Pest)
- run frontend tests (Jest)
- run browser tests (Playwright)

release:
needs: test
runs-on: ubuntu-latest
steps:
- checkout
- setup node
- setup composer
- run semantic-release
env:
GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}

- Run lint and formatting checks before tests to stop invalid pushes early.  
- Matrix tests allow multiâ€‘environment validation.  
- Semantic release triggers only when all tests pass validating merges adhere to commit conventions. (CI/CD best practices)  [oai_citation:0â€¡CodeWithGillis](https://codewithgillis.com/building-enterprise-grade-frontend-applications-a-complete-guide-to-advanced-project-structure/?utm_source=chatgpt.com)

---

## âš™ï¸ Code Quality & Tooling

### ğŸ§¹ Linting & Formatting

Use standardized tooling ecosystem:

ESLint + @eslint/js + typescript-eslint
Prettier + prettierâ€‘pluginâ€‘organizeâ€‘imports + prettierâ€‘pluginâ€‘tailwindcss
eslintâ€‘configâ€‘prettier

- ESLint enforces JS/TS best practices.
- Prettier ensures uniform formatting.
- Prettier plugins optimize Tailwind utilities and import ordering.
- Configured to run via **Husky preâ€‘commit hooks** to guarantee consistency on staging branches.  [oai_citation:1â€¡CodeWithGillis](https://codewithgillis.com/building-enterprise-grade-frontend-applications-a-complete-guide-to-advanced-project-structure/?utm_source=chatgpt.com)

---

## ğŸª Preâ€‘Commit Hooks (Husky + Commitlint)

Husky hooks enforce local safety checks:

.pre-commit:
lint-staged:
- â€˜.ts?(x)â€™: eslint
- â€™.js?(x)â€™: eslint
- â€˜.jsonâ€™: prettier
- â€™.phpâ€™: laravel pint

Commit message standardization:

@commitlint/config-conventional

Commitlint ensures messages follow Conventional Commits spec, enabling automated semantic versioning and release changelog generation.  [oai_citation:2â€¡CodeWithGillis](https://codewithgillis.com/building-enterprise-grade-frontend-applications-a-complete-guide-to-advanced-project-structure/?utm_source=chatgpt.com)

---

## ğŸ“¦ Automated Releases (semanticâ€‘release)

Use **semanticâ€‘release** to automate:

- Version bumping (semver)  
- Changelog generation (@semantic-release/changelog)  
- Git tagging & version commits (@semantic-release/git)  
- GitHub Releases (@semantic-release/github)

Rules driven by commit messages:

feat: minor bump
fix: patch bump
BREAKING CHANGE: major bump

Semantic release eliminates manual version updates and standardizes release artifacts.  [oai_citation:3â€¡CodeWithGillis](https://codewithgillis.com/building-enterprise-grade-frontend-applications-a-complete-guide-to-advanced-project-structure/?utm_source=chatgpt.com)

---

## ğŸ§ª Testing Workflows

### ğŸ’¥ Backend Testing (Pest + PHPUnit)

Focus areas:

- Unit tests for services, actions, helpers  
- Feature tests for HTTP + Inertia responses  
- Policy/authorization tests
- Scout + Meilisearch indexing tests
- Localization routing & fallback tests
- Notification & broadcast behavior

Example backend scenario:

test(â€˜localized homepage returns correct propsâ€™, function () {
$this->get(â€™/enâ€™)->assertInertia(fn($page) => $page->where(â€˜localeâ€™,â€˜enâ€™));
});

Pest improves readable tests and integrates with Laravel seamlessly.  [oai_citation:4â€¡Reddit](https://www.reddit.com/r/laravel/comments/1b73mv3?utm_source=chatgpt.com)

---

### ğŸ§  Frontend Testing

#### ğŸ§© Unit & Component Tests

Use **Jest + React Testing Library**:

- Test isolated React components
- Mock Zustand stores + i18next
- Validate UI behavior and accessibility

Examples:

test(â€˜renders localized textâ€™, () => {
render();
expect(screen.getByText(/welcome/i)).toBeInTheDocument();
});

---

### ğŸŒ Endâ€‘toâ€‘End (Playwright)

Browser tests simulate real user flows including:

- Navigation
- Localization behavior
- Form interactions
- Authentication flows
- SSR hydration behavior

Use **pestâ€‘pluginâ€‘browser** to run E2E tests via PHP test suite for consistency. Tests can verify full stack flows in a CI environment.  [oai_citation:5â€¡Reddit](https://www.reddit.com/r/laravel/comments/1j052ij?utm_source=chatgpt.com)

---

## ğŸ“ˆ Deployment & Infrastructure

### Dockerized Deployment

Use multiâ€‘stage Docker builds:

FROM composer as vendor
COPY composer.json composer.lock ./
RUN composer install â€“no-dev

FROM node as frontend
COPY package.json package-lock.json ./
RUN npm install

FROM laravel/app
COPY . .
COPY â€“from=vendor /vendor ./vendor
COPY â€“from=frontend /node_modules ./node_modules
RUN npm run build

CMD [â€œphp-fpmâ€]

Add web server (Nginx) config for SSR and Inertia routing.

---

## ğŸª™ Performance & Monitoring

Integrate:

- Application performance monitoring (Sentry, Datadog)
- Realâ€‘time metrics (Prometheus, Grafana)
- Logging & observability (ELK, Seq)
- Health checks & uptime monitoring

---

## ğŸ“Œ Summary (DevOps, Testing & CI/CD)

| Concern | Tooling / Strategy |
|---------|------------------|
| Linting | ESLint + Prettier |
| Formatting | Prettier + Tailwind Plugin |
| Commit Quality | Husky + Commitlint |
| Automated Releases | semanticâ€‘release |
| Backend Tests | Pest + PHPUnit |
| Frontend Tests | Jest + RTL |
| Browser E2E | Playwright |
| CI/CD | GitHub Actions Matrix |
| Dockerization | Multiâ€‘stage images |
| Monitoring | Sentry + Prometheus |

---