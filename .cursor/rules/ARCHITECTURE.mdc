---
alwaysApply: true
name: enterpriseâ€‘riltâ€‘stackâ€‘partâ€‘1
description: "Partâ€¯1 of the architecture definition for a fully localized Laravelâ€¯12 + Inertiaâ€¯2.3.7 + Reactâ€¯19.2.0 application with Scout/Meilisearch, mcamara/localization, SOLID/CLEAN/DRY design, Filament admin, SSR/SEO optimization, and backend conventions. Optimized for AI reasoning and code generation."
license: MIT
metadata:
  author: yourâ€‘team
---

# ğŸ§  Architecture â€” Partâ€¯1: Backend Core (Laravelâ€¯12)

## ğŸš€ **1. Core Architectural Vision**

This backend architecture is designed for:

- **Scalable, maintainable domains** with clear separation of concerns
- **SOLID / CLEAN / DRY** principles enforced through structure
- **Inertia SSR** delivering SEOâ€‘ready server renders
- **Localization** with route prefixes and internal content translation
- **Search** via **Laravel Scout + Meilisearch** for realâ€‘time search features
- **Admin UI** via Filament
- **Realâ€‘time** updates via broadcast

This structure enables multiple teams to work in parallel while minimizing coupling and maximizing reuse.

---

## ğŸ“ **2. Backend Folder & Domain Structure**

app/
â”œâ”€â”€ Core/                       # Cross-domain infrastructure
â”‚   â”œâ”€â”€ Contracts/              # Shared interfaces (e.g. PagePropsServiceInterface)
â”‚   â”œâ”€â”€ Exceptions/             # DomainException and shared exceptions
â”‚   â”œâ”€â”€ Middleware/             # Global HTTP middleware (HandleInertiaRequests, HandleAppearance, etc.)
â”‚   â”œâ”€â”€ Models/                 # Cross-cutting models (Language, Setting, FeatureFlag)
â”‚   â”œâ”€â”€ Observers/              # Observers for Core models (LanguageObserver, SettingObserver)
â”‚   â”œâ”€â”€ Policies/               # Policies for Core models (FeatureFlagPolicy)
â”‚   â”œâ”€â”€ Providers/              # AppServiceProvider, Fortify, Telescope, Horizon, Filament AdminPanel
â”‚   â”œâ”€â”€ Services/               # Shared services (e.g. PagePropsService for Inertia props)
â”‚   â”œâ”€â”€ Support/                # Helpers, base classes
â”‚   â””â”€â”€ Traits/                 # Shared model/controller traits
â”œâ”€â”€ Domains/                    # Feature-based vertical slices; each owns its HTTP, Models, Observers, Policies, Jobs
â”‚   â”œâ”€â”€ Auth/                   # Models/User, Policies/UserPolicy, Actions (Fortify), Jobs/ (optional)
â”‚   â”œâ”€â”€ Blog/                   # Http/, Models/BlogPost, Queries, Search, Policies, Jobs/ (optional)
â”‚   â”œâ”€â”€ Contact/                # Http/, Models/ContactSubmission, Actions, Policies, Jobs/ (optional)
â”‚   â”œâ”€â”€ Dashboard/              # Http/Controllers, Jobs/ (optional)
â”‚   â”œâ”€â”€ Landing/                # Http/, Models/, DTOs, Services, Observers, Policies, Jobs/ (optional)
â”‚   â”œâ”€â”€ Pages/                  # Http/, Models/Page, Queries, Search, Observers, Policies, Jobs/ (optional)
â”‚   â”œâ”€â”€ Profile/                # Http/Controllers, Http/Requests (profile, password, 2FA), Jobs/ (optional)
â”‚   â””â”€â”€ Search/                 # Http/Controllers (orchestrates Blog + Pages search), Jobs/ (optional)
â”œâ”€â”€ Features/                   # Pennant feature-flag definitions only (BlogFeature, ContactFormFeature, PagesFeature)
â”œâ”€â”€ Filament/                   # Admin UI only; resources reference Core/Domain models
â”œâ”€â”€ Http/
â”‚   â””â”€â”€ Controllers/Controller.php   # Base controller only; domain controllers extend it
â””â”€â”€ Rules/                      # Optional: custom validation rules

**Domain HTTP:** Controllers and Requests live inside each domain under `Domains/<Name>/Http/Controllers/` and `Domains/<Name>/Http/Requests/`. Routes point to these domain controllers (e.g. `App\Domains\Blog\Http\Controllers\BlogController`). There is no global `app/Http/Controllers/Web/` or `app/Http/Controllers/Settings/`. **Models** live in `Core/Models/` (Language, Setting, FeatureFlag) or in each domain under `Domains/<Name>/Models/`; there is no top-level `app/Models/`. **Middleware** live in `Core/Middleware/` (HandleInertiaRequests, HandleAppearance, SetLocalizedFortifyRedirects, EnsureUserHasAdminRole); `app/Http/` holds only the base Controller.

**Domain structure per slice:** Each domain may contain **Models/**, **Observers/**, **Policies/**, **Http/**, **Queries/**, **Services/**, **Search/**, **Actions/**, **DTOs/**, **Jobs/** (queued jobs for that domain), and optionally **Providers/**. **Core** may contain **Jobs/** for cross-cutting queued work (e.g. search reindexing that spans domains). There is no global `app/Jobs/`; jobs live in `Domains/<Name>/Jobs/` or `Core/Jobs/`. **Core** holds cross-cutting **Models/** (Language, Setting, FeatureFlag), **Observers/**, **Policies/**, and **Providers/** (AppServiceProvider, Fortify, Telescope, Horizon, Filament). **PagePropsService** lives in `Core/Services/` and implements `Core/Contracts/PagePropsServiceInterface`; it builds the settings slice and feature-flags array for Inertia shared props. Policies are registered in `Core/Providers/AppServiceProvider::registerPolicies()`.

### ğŸ“Œ Domain Concepts

- **Controllers** live in `Domains/<Name>/Http/Controllers/`. They are thin: call domain Queries/Services/Actions, merge with PagePropsService when needed, return `Inertia::render(...)`. They extend `App\Http\Controllers\Controller`.
- **Requests** (FormRequests) live in `Domains/<Name>/Http/Requests/` alongside their controllers.
- **Domains** encapsulate all domain logic: Http (entry points), Queries, Services, Search, Actions, DTOs.
- **Core** holds cross-cutting code only: Middleware, Models (Language, Setting, FeatureFlag), Observers, Policies, Providers, PagePropsService, contracts, exceptions, traits.
- **Filament** is UI-only; resources use Domain Queries or model scopes, not inline business logic.
- **Features/** (Pennant) = feature-flag definitions; do not confuse with frontend â€œfeaturesâ€ or Domains.

### Naming conventions (Backend)

- **PHP files and classes:** PascalCase (e.g. `BlogController`, `PagePropsService`, `BlogPost`).
- **Namespaces:** Match folder structure.
- **Filament resources:** Plural resource name (e.g. `BlogPosts`, `Pages`); CRUD pages under `ResourceName/Pages/` (e.g. `ListBlogPosts`, `CreateBlogPost`, `EditBlogPost`).

**IDE Helper (barryvdh/laravel-ide-helper):** Model discovery uses `config/ide-helper.php` â†’ `model_locations`: `app/Core/Models` and each `app/Domains/<Name>/Models`. Run `php artisan ide-helper:models -M` (or `composer run post-autoload-dump`) to regenerate `_ide_helper_models.php` after adding or moving models.

### ğŸ—‘ï¸ Soft Deletes and Cascading

All CMS and future domain models use `SoftDeletes`.

- **Cascaded soft deletes:** When a parent is soft-deleted, child models are soft-deleted (e.g. via model events, observers, or explicit `delete()` in `boot()`). Prefer a trait or base observer when the pattern repeats.
- **Cascaded hard deletes:** When a parent is force-deleted, related rows are force-deleted: use DB foreign key `cascadeOnDelete()` where applicable, plus application-level force-delete in observers for soft-deletable children so they are force-deleted when the parent is force-deleted.

**Parent/child relationships:** `Language` is parent of `Page` (pages cascade when a language is force-deleted). **BlogPost** is parent of Media (polymorphic, via Spatie Media Library): when a BlogPost is force-deleted, all associated media (gallery, videos, documents) are deleted (files and DB rows) by the media library trait. **LandingSection** is parent of `LandingSectionItem` (FK `cascadeOnDelete`) and of media (Spatie Media Library `image` collection): when a LandingSection is force-deleted, section items are force-deleted by the foreign key, and media are removed by the media library trait. `Setting` and `ContactSubmission` have no child entities; document any new cascade rules in this section when adding relations.

**User model:** `User` also uses `SoftDeletes`; the Filament User resource supports trashed filter, restore, and force-delete actions. **Setting** has no soft deletes by design (singleton site settings).

---

## ğŸŒ **3. Localization (Global Backend Strategy)**

### ğŸ” Routing & Middleware

Use **mcamara/laravelâ€‘localization** to prefix all routes with locale identifiers.

**bootstrap/app.php:** Register middleware aliases: `localize` (LaravelLocalizationRoutes), `localizationRedirect` (LaravelLocalizationRedirectFilter), `localeSessionRedirect` (LocaleSessionRedirect), `localeCookieRedirect` (LocaleCookieRedirect), `localeViewPath` (LaravelLocalizationViewPath), `setLocalizedFortifyRedirects` (SetLocalizedFortifyRedirects). Prepend `LocaleSessionRedirect` to the web stack so `/` redirects to the preferred locale.

**routes/web.php:** Use a route group with `prefix => LaravelLocalization::setLocale()` and middleware `localeSessionRedirect`, `localizationRedirect`, `localeViewPath`, `setLocalizedFortifyRedirects`. The package sets app locale (and translator/regional) when the prefix is evaluated per request. Call `Fortify::ignoreRoutes()` in FortifyServiceProvider::register(), then require Fortify routes inside the locale group so auth is under `/{locale}/login`, etc. SetLocalizedFortifyRedirects sets Fortify redirect config from `app()->getLocale()` so login/logout stay in the current locale.

**config/laravellocalization urlsIgnored:** Only `/skipped` and `/admin`, `/admin/*`. Do not ignore login/register so they stay under the locale prefix.

- Language is detected from URL, session, or browser headers.
- **middleware layers** ensure locale persistence and correct redirection.

### ğŸ“š Multiâ€‘Locale Content

- Leverage Laravelâ€™s translation system for static strings (JSON or PHP).  
- For dynamic content (titles/descriptions stored in DB), use JSON columns or translation tables (rowâ€‘perâ€‘language pattern).  [oai_citation:1â€¡Reddit](https://www.reddit.com/r/laravel/comments/1j3613p)

### ğŸ“„ Localized CMS (multiâ€‘locale content)

- **Pages:** Row-per-locale: `Page` has `language_id` (FK to `languages`). One row per locale per logical page (e.g. privacy EN, privacy DE). Slug/title/body on `Page`; resolve by locale/slug in controllers.
- **Settings:** Single global site settings. Translatable fields (company name, tagline, address, etc.) via **Spatie Laravel Translatable** (JSON columns). No `language_id`; locale chosen at runtime.
- **Blog:** `BlogPost` uses Spatie Translatable for `title`, `excerpt`, `body`, `meta_description`. Rely on Translatable and app locale. Blog posts support rich content (WYSIWYG in Filament), media (images in `gallery`, videos in `videos`, files in `documents` via Spatie Media Library). The public show page uses Yet Another React Lightbox (YARL) for gallery and video with plugins: Captions, Fullscreen, Slideshow, Thumbnails, Video, Zoom.
- **Contact form:** `ContactSubmission` stores submissions (name, email, subject, message). No translation; optionally store `locale` for analytics.
- **Landing page sections:** `LandingSection` (types: hero, features, testimonials, cta) and `LandingSectionItem` (for features/testimonials) use Spatie Translatable for titles, body, CTAs, and Spatie Media Library for section images and item icons. The public welcome page renders sections from the DB; when no hero section exists, fallback uses `Setting` and `lang` messages.
- **Language model:** `languages` table keyed by code (e.g. `en`, `de`). Seed from `config('laravellocalization.supportedLocales')`. Used by `Page` (`language_id`) and anywhere an FK to a locale is needed.

### ğŸª Best Practices

- Use PHP arrays for structured groups; use JSON for UI labels/shared strings.  [oai_citation:2â€¡Reddit](https://www.reddit.com/r/laravel/comments/1q09zk6/which_translation_style_do_you_use/)  
- Combine with Carbon locale settings for date, number, currency formatting.  [oai_citation:3â€¡Phrase](https://phrase.com/blog/posts/laravel-i18n-frontend-best-practices/)

---

## ğŸ” **4. Full Search â€” Scout + Meilisearch**

Use **Laravel Scout** configured to use **Meilisearch** for fullâ€‘text, faceted, typoâ€‘tolerant search.  [oai_citation:4â€¡Laravel](https://laravel.com/docs/12.x/scout)

### ğŸš€ Setup

- Install Meilisearch driver and packages.  
- Set environment variables in `.env`:  

SCOUT_DRIVER=meilisearch
MEILISEARCH_HOST=http://127.0.0.1:7700
MEILISEARCH_KEY=masterKey

### ğŸ“¦ Search Integration

- Mark searchable models with Scout trait.
- Implement `toSearchableArray()` to tailor indexed data.
- Use filters & synonyms to support multilingual search relevance.

### ğŸ“Œ Tips

- Always flush and sync after changing searchable fields to avoid stale index states.  [oai_citation:5â€¡Reddit](https://www.reddit.com/r/laravel/comments/1b0271f)  
- For large datasets, incremental indexing jobs are recommended.

---

## ğŸ‘¤ **5. Authentication & Authorization**

- Use **Laravel Fortify** for credentials, MFA, and session handling.  
- Shared auth props provided to Inertia every request.  
- Define **Policies** per resource to enforce business rules.

### Roles and permissions workflow (Spatie Permission)

When adding new guarded features or Filament resources: (1) Add the permission(s) (e.g. `manage X`) in `database/seeders/RoleAndPermissionSeeder.php`. (2) Assign to the appropriate role (e.g. admin). (3) Document new permissions in that seeder or in ARCHITECTURE. (4) Use policies and Filament authorization so only users with the right permission can access the resource. When adding a new Filament resource, add a corresponding permission and seed it so roles can be updated over time.

---

## ğŸš© **5a. Feature Flags â€” Laravel Pennant**

Use **Laravel Pennant** for all feature flagging: gradual rollouts, A/B tests, and conditional features. **Always** gate optional or experimental features (blog, static pages, contact form, registration, 2FA, any new module) via Pennant.

- **Define features** in `app/Features/` and register with `Feature::define()` in `AppServiceProvider`. Use the `Feature` facade and the `@feature` Blade directive (or server-side checks) in controllers and Filament to gate UI and behavior.
- **Toggle in Filament:** Admins can enable/disable feature flags from the **Feature flags** resource in Filament (Settings group). Document toggleable features in `config/features.php` (keys and labels). Seed with `FeatureFlagSeeder`; add new entries to config and run the seeder when introducing a new toggleable feature.
- **Current usage:** Gate registration, two-factor auth, blog, pages, contact form, and other Fortify/application features so they can be toggled per environment or audience.
- **Future features:** Any new optional or experimental feature must get a Pennant flag, be added to `config/features.php` if admin-toggleable, and be documented in ARCHITECTURE or README.
- **Testing:** Use Pennantâ€™s in-memory driver or `Feature::activate()` / `Feature::deactivate()` in tests to assert both on/off states.

---

## ğŸŒ **6. Realâ€‘Time & Background Jobs**

- **Laravel Reverb** for WebSockets and user notifications. 
- Use Events + Listeners for domain events (e.g., user registered, order placed). 
- **Jobs** live in **Domains/<Name>/Jobs/** or **Core/Jobs/** (no global `app/Jobs/`). Use `ShouldQueue` for async tasks (email, search reindexing, analytics).

---

## ğŸ§‘â€ğŸ’¼ **7. Admin Dashboard â€” Filament**

Filament manages administrative UIs, forms, tables, and resource pages.

app/
â””â”€â”€ Filament/
â”œâ”€â”€ Resources/
â”‚   â”œâ”€â”€ FeatureFlags/
â”‚   â”‚   â””â”€â”€ FeatureFlagResource.php   # Feature flags: list and edit (syncs to Pennant)
â”‚   â”œâ”€â”€ UsersResource.php
â”‚   â”œâ”€â”€ RolesResource.php
â”‚   â””â”€â”€ â€¦
â”œâ”€â”€ Pages/
â”œâ”€â”€ Widgets/

- Leverage policies & roles for admin access control.
- **Feature flags resource:** Under Settings, lists and edits feature flags (from `config/features.php`; seeded by `FeatureFlagSeeder`). Changes sync to Pennant. Access via â€œmanage feature flagsâ€ permission.
- Extend Filament with custom tools, reports, and charts.

### Filament CLI (resources and widgets)

- **Resources:** `php artisan make:filament-resource ModelName --generate --soft-deletes` when the model uses soft deletes. Use `--simple` for no dedicated List/Create/Edit/View when appropriate.
- **Widgets:** `php artisan make:filament-widget WidgetName`; add `--stats-overview` or `--chart` as needed.
- Resources, pages, and widgets are discovered from `app/Filament/Resources`, `app/Filament/Pages`, `app/Filament/Widgets`. See [Filament 5 Navigation](https://filamentphp.com/docs/5.x/navigation/overview) for navigation groups, labels, and icons: use `$navigationGroup`, `$navigationLabel`, `$navigationSort`, `$navigationIcon` on resources and pages.

### Translatable resources (Lara Zeus)

For models using **Spatie Laravel Translatable**, use **lara-zeus/spatie-translatable** in Filament: apply the resource/page `Translatable` trait and add `LocaleSwitcher::make()` in `getHeaderActions()` on List, Create, Edit (and View) pages. Configure translatable locales to match `config('laravellocalization.supportedLocales')` or override `getTranslatableLocales()` on the resource.

---

## ğŸ“¦ **8. Metadata & SEO Backend Strategy**

- Inject SEO meta (title/description/OG) via Inertia SSR props.  
- Provide **hreflang** alternate links for each locale in head.  
- Generate sitemap & robots via scheduled commands.

---

## ğŸ§ª **9. Testing Backend with Pest + PHPUnit**

**Backend Tests:**

- Unit test services and actions
- Feature test controllers with Inertia payload asserts
- Localization route tests
- Search indexing & result tests
- Policy tests
- Queue job behavior

Example:
```php
test('homepage localized', function () {
    $this->get('/en')->assertInertia(fn($page) => $page->where('locale','en'));
});
```

Scenarios should be contrived to ensure locale fallbacks and error states.

---

ğŸ“Œ Summary & Backend Principles

Objective	Strategy
Separation of concerns	Actions + DTOs + Controllers
Search	MeiliSearch via Scout
Localization	Route prefixes + i18next sync
Realâ€‘Time	Reverb + Echo
Admin	Filament resources
SEO	SSR + meta + sitemap
Testing	Pest + PHPUnit coverage


---

# ğŸ§  Architecture â€” Partâ€¯2: Frontend & UI

## ğŸ“¦ Overview: Frontend Stack

Frontend is built with:

- **React 19.2.0** with **Inertia.js** as the BFF/SSR glue  
- **Shadcn UI** primitives and **Radix** for accessible components  
- **Tailwindâ€¯CSS** + **Tailwindâ€‘Merge** for atomic utility styles  
- **i18next** + **i18nextâ€‘browserâ€‘languagedetector** for UI i18n  
- **Zustand** for UI and client state not provided by backend  
- **Vite** as build tool with SSR capabilities
- **Motion** (motion/react) with LazyMotion for page/section animation; Tailwind enter/exit utilities for Shadcn components.

This setup reflects common modern patterns for Laravel + React with **no separate API** layer, reducing complexity and keeping routing / SSR tightly integrated. ([turn0search7])

---

## ğŸ§© Directory Structure (Frontend)

resources/
â””â”€â”€ js/
â”œâ”€â”€ app.tsx                     # Inertia entry and SSR integration
â”œâ”€â”€ ssr.tsx                     # SSR entry
â”œâ”€â”€ pages/                      # Inertia page components (SSR); names match backend (e.g. auth/login, blog/Index)
â”œâ”€â”€ layouts/                    # Shared layout components (auth, app, settings, public)
â”œâ”€â”€ components/                 # Shared reusable components
â”‚   â”œâ”€â”€ ui/                     # Shadcn UI extensions/adapters
â”‚   â””â”€â”€ common/                 # Generic, shared UI parts (LabeledInputField, motion-presets, PaginatorLinks, SeoHead)
â”œâ”€â”€ features/                   # Feature modules (vertical slices); see features/README.md
â”‚   â”œâ”€â”€ auth/                   # components/, hooks/, services/, types.ts, index.ts
â”‚   â”œâ”€â”€ blog/                   # components/, hooks/, services/, types.ts, index.ts
â”‚   â”œâ”€â”€ contact/                # components/, hooks/, services/, types.ts, index.ts
â”‚   â”œâ”€â”€ dashboard/              # components/, hooks/, services/, types.ts, index.ts
â”‚   â”œâ”€â”€ landing/                # components/, hooks/, services/, types.ts, index.ts
â”‚   â”œâ”€â”€ pages/                  # CMS page feature (components/, hooks/, services/, types.ts, index.ts)
â”‚   â””â”€â”€ profile/                # profile & settings (components/, hooks/, services/, types.ts, index.ts)
â”œâ”€â”€ context/                    # Optional React contexts (ThemeContext, AuthContext)
â”œâ”€â”€ hooks/                      # Shared React hooks (use-appearance, use-mobile, use-initials, etc.)
â”œâ”€â”€ i18n/                       # i18next configuration + translation files
â”œâ”€â”€ lib/                        # Shared helpers (e.g. lib/utils.ts for cn, decodeHtml)
â”œâ”€â”€ services/                   # Central config (e.g. inertiaConfig.ts for CSRF/headers)
â”œâ”€â”€ store/                      # Zustand state modules
â”œâ”€â”€ themes/                     # Theme definitions (light.ts, dark.ts, sepia.ts, index.ts)
â”œâ”€â”€ types/                      # Shared TS types (backend DTO mirrors)
â””â”€â”€ (wayfinder-generated: actions/, routes/, wayfinder/)

**Path aliases:** `@/*` â†’ `resources/js/*`; optional `@features/*` â†’ `resources/js/features/*`. Inertia pages live in `resources/js/pages/` with the same names as backend `Inertia::render()` (e.g. `auth/login`, `blog/Index`, `welcome`).

Frontend tests may live in `tests/` at repo root (e.g. Pest Browser/Playwright) or in `resources/js/__tests__/` when using Jest/RTL; align with project setup.

### Naming conventions (Frontend)

- **Page files:** kebab-case or PascalCase consistently (e.g. `login.tsx`, `Index.tsx`); auth/settings typically kebab-case.
- **Layout files:** kebab-case (e.g. `public-layout.tsx`, `app-sidebar-layout.tsx`).
- **Component files:** kebab-case (e.g. `appearance-toggle-tabs.tsx`, `text-link.tsx`); `common/` may use PascalCase for component files (e.g. `LabeledInputField.tsx`).
- **React components and default exports:** PascalCase.
- **Hooks:** file names kebab-case (`use-mobile.tsx`, `use-appearance.tsx`); hook names `use*` PascalCase (e.g. `useIsMobile`, `useAppearance`).

### ğŸƒ UI Principles

- Shadcn UI + Radix for accessible, composable UI primitives.  
- Tailwind CSS for consistent layout & responsive styles.  
- Use **atomic UI systems** with Tailwind variants and `classâ€‘varianceâ€‘authority` for stronglyâ€‘typed style configs.

Shadcn UI drastically accelerates UI scaffolding of consistent design components and props patterns. ([turn0search1])

### Use ui first

- Prefer **Shadcn components in `components/ui`** for all interactive and structural UI: buttons, links that look like buttons, form fields (inputs, textareas, labels), cards, alerts, modals, navigation, etc.
- Use **custom Tailwind only when** no ui component fits (e.g. layout, spacing, one-off decorative elements) or to extend a ui component via `className`.
- Do not reinvent buttons, form controls, or cards with raw HTML and Tailwind; use `Button`, `Input`, `Label`, `Textarea`, `Card`, `Alert`, etc. from `components/ui`.

---

## ğŸŒ Localization (Frontend)

### ğŸ§  i18next Setup

Use **i18next** + **i18nextâ€‘browserâ€‘languagedetector** with React:

- Define supported languages (`en`, `it`, `de`, `es`, `fr`, `ru`, `zh`, `fa`, `ar`, `jp`, `kr`)
- Use lazy loading of translation namespaces per page/feature to optimize bundle size and avoid loading all languages at once. ([turn0search12])
- Sync backend locale with i18next on Inertia SSR props so both ends share current locale context.

Example i18n init:

```ts
import i18n from 'i18next';
import LanguageDetector from 'i18next-browser-languagedetector';
import { initReactI18next } from 'react-i18next';

i18n.use(LanguageDetector)
  .use(initReactI18next)
  .init({
    supportedLngs: [...],
    fallbackLng: 'en',
    detection: { order: ['querystring','cookie','localStorage'] },
    interpolation: { escapeValue: false },
  });
```

export default i18n;

ğŸ”‘ Ensure translation files are namespaced (core, pages, components) for scalability.

âš ï¸ Avoid loading all languages on initial load â€” prefer namespace lazy loads to reduce bundle size and improve performance. (See best practices for i18n). ([turn0search12], [turn0reddit28])

---

ğŸ” Sync Locale with Backend

Pass backend locale to frontend via Inertia shared props:

Inertia::share('locale', app()->getLocale());

Use this to preâ€‘set i18next and adjust UI direction (ltr / rtl) dynamically; e.g., document.documentElement.setAttribute('dir', 'rtl') for Arabic.

---

ğŸ¨ Theme (light / dark / system)

Always use **light / dark / system** appearance for the frontend and all UI:

- Use a single source of truth (e.g. `useAppearance` hook) that supports `light`, `dark`, and `system`. Persist choice in localStorage and a cookie so SSR can align.
- Apply theme to the document root: toggle a `dark` class on `<html>` and set `color-scheme` so Shadcn/Tailwind dark variants and system UI (scrollbars, etc.) match.
- All layouts and components should rely on this theme (no adâ€‘hoc dark mode toggles). Prefer Tailwind `dark:` utilities and Shadcn theme-aware components.
- If using Sonner/Toaster, feed its `theme` prop from the same source (e.g. `useAppearance().resolvedAppearance`) so there is a single source of truth; avoid mixing next-themes and a custom appearance hook.
- **Theme switcher** and **language switcher** are available in the public layout (header) and app layout (sidebar footer). The theme switcher uses `useAppearance` and persists via cookie/localStorage; the language switcher uses shared `locale_switch_urls` from the backend (mcamara `getLocalizedURL`) so each option links to the same page in another locale.

---

â†”ï¸ RTL and directionâ€‘aware UI

Support RTL (e.g. `ar`, `fa`) consistently:

- Set `document.documentElement.setAttribute('dir', â€¦)` from the active locale (e.g. in Inertia setup). Use a small set of RTL locales (e.g. `ar`, `fa`) and default to `ltr` otherwise.
- **Icons and arrows:** Use direction-aware icons (e.g. chevrons that flip in RTL, or separate â€œnextâ€/â€œpreviousâ€ semantics) so navigation and flows make sense in both directions.
- **Spacing:** Prefer logical properties: use Tailwind `ps-*`/`pe-*` or `start`/`end` (e.g. `ms-2` â†’ `ms-2` for â€œmargin after content in reading directionâ€) so padding and margins respect RTL/LTR. Avoid hard-coded `ml`/`mr` for directional meaning.
- **Refactor:** After adding these rules, refactor existing layouts, nav, and forms to use RTL-friendly spacing and icons so behavior is consistent in all locales.

---

ğŸ¬ Motion & animation (UI/UX)

- **Stack:** Motion (motion/react) v12 with `LazyMotion` + `domAnimation` in `app.tsx` to keep bundle size down. Tailwind-based enter/exit (e.g. tw-animate-style utilities) for Shadcn/Radix components (tooltips, sheets, popovers, dropdowns, navigation menus, etc.).
- **Single source of truth:** Page and section animation config lives in `components/common/motion-presets.ts`:
  - **pageEnter** â€” layout/page wrapper on mount (opacity + y, 0.3s).
  - **fadeInUp** â€” hero/above-fold on mount (0.35s).
  - **fadeInUpView** â€” scroll-in content (viewport, once, margin), 0.4s.
- **Usage:** Use `m` from `motion/react` with these presets for page wrappers and content sections. For new â€œpage enterâ€ or â€œscroll-inâ€ patterns, add a named preset instead of ad-hoc `initial`/`animate`/`transition` in pages (DRY). Allowing inline `transition` overrides only when extending a preset (e.g. stagger delay, or short duration for hover/tap) is acceptable; document that preference.
- **UI primitives:** Use Tailwind `animate-in`/`animate-out` and `transition-*` only for Shadcn/Radix overlays and micro-interactions, not for page-level motion.
- **Accessibility:** Consider `prefers-reduced-motion` for future motion work or global overrides.

---

ğŸ§  Global State (Zustand)

Use Zustand for frontend state not derived from backend domain data:

store/
â”œâ”€â”€ ui.ts        # modal, alert state
â”œâ”€â”€ preferences.ts  # theme, locale UI preferences
â”œâ”€â”€ form.ts      # persistent form state outside backend

Example store:

const useUIStore = create((set) => ({
  theme: 'light',
  setTheme: (theme) => set({ theme }),
}));

Zustand avoids mounting multiple contexts and scales well with selectors for optimized reâ€‘rendering.

---

ğŸ“¡ Realtime & Inertia

Inertia 2â€™s SSR and async features allow:
	â€¢	Deferred, lazy props to reduce blocking time on heavy queries
	â€¢	Async navigation looks instant with prefetch + caching
	â€¢	Inertia reduces the need for a traditional API layer, decreasing surface area and overhead. ([turn0search7])

---

ğŸ” SEO & SSR

ğŸ“¢ Inertia SSR
	â€¢	Inertia SSR outputs full HTML with localized <head> tags (title, description, OG).
	â€¢	Meta tags are page scoped and passed in SSR props.
	â€¢	Use Inertia <Head> component per page for SEO.

Example:

<Head title={t('home.title')} meta={[{name:'description', content:t('home.desc')}, ...]} />

âš ï¸ Always include localized hreflang for alternate languages to signal search engines. Ensure sitemap entries include locales.

SSR strategy:
	â€¢	Render content server side to improve search indexing and initial load.
	â€¢	Use HTTP cache headers to improve performance.

---

âš™ï¸ UI Component Categorization

ğŸ“¦ ui/ (Shadcn + Radix)
	â€¢	Button, Input, Label, Textarea, Card, Alert, Sheet, Popover, Dropdowns, Modals, Navigation, etc.
	â€¢	**First choice for all UI.** Use these before adding custom markup.

ğŸ“¦ common/
	â€¢	Shared compositions that **use** ui primitives and are used across multiple pages or layouts: NavSearch, language switcher, theme switcher, SocialLinks, SeoHead, BackButton, PaginatorLinks. **Motion presets** (`motion-presets.ts`) live here as the single source of truth for page/section animation; use them instead of ad-hoc animation config (DRY). Shared UX patterns (e.g. link styling, appearance toggle) are implemented via components that consume ui primitives.

ğŸ“¦ features/<name>/components/
	â€¢	Feature-specific compositions built from ui (and optionally common) for a single feature area (e.g. BlogPostCard, contact form). Each feature lives under `resources/js/features/<name>/` with components/, hooks/, services/, types.ts, index.ts.

Design intent: components are isolated by scope; feature-scoped UI in `resources/js/features/*/components/`, shared UI in `resources/js/components/`. Always prefer ui primitives over reinventing with raw HTML and Tailwind.

Use shared components for repeated UX: **TextLink** for inline links (underline, transition-colors), **AppearanceToggleTab** / theme-switcher for theme, language-switcher for locale. Keeps link and theme behavior consistent and DRY.

---

ğŸ“ˆ Performance & Optimization
	â€¢	Lazy load page props and translation namespaces.
	â€¢	Use SSR + caching for meta/critical resources.
	â€¢	Vite prefetch bundles, route prefetching, and code splitting.
	â€¢	Use optimized image handling and dynamic imports.
	â€¢	Use **LazyMotion** (domAnimation) for Motion so animation is lazy-loaded and bundle size stays minimal.

---

ğŸ§ª Frontend Testing

ğŸ§© Component Tests
	â€¢	Jest + React Testing Library
	â€¢	Test UI logic, interactions, and localized content.

ğŸ§ª Endâ€‘toâ€‘End Tests
	â€¢	Playwright via Pest plugin for browser flows
	â€¢	Combined with Inertia SSR ensures full coverage.

Example Playwright E2E:

test('localized homepage loads', function () {
  $page = visit('/');
  $page->assertSee('Welcome');
});


---

ğŸ“Œ Summary (Frontend)

Concern	Solution
Component choice	Prefer components/ui (Shadcn); custom Tailwind only when no ui component fits
UI Library	Shadcn + Radix + Tailwind
Theme	Light / dark / system via useAppearance; document root class + color-scheme; theme + language switchers in public and app layouts
Locales	i18next + Inertia shared props; language switcher uses shared locale_switch_urls (mcamara)
RTL	Dynamic dir; direction-aware icons and logical spacing (start/end, ps/pe)
Motion / UX	Motion (LazyMotion + domAnimation) + motion-presets for page/section animation; Tailwind enter/exit for Shadcn; prefer presets, extend presets for new variants (DRY)
Global State	Zustand
SEO/SSR	Inertia SSR + Inertia Head metadata
Performance	Prefetch + lazy load
Testing	Jest + Playwright


---

# ğŸ¤– Architecture â€” Partâ€¯3: DevOps, Quality, CI/CD & Releases

## ğŸ“ˆ Continuous Integration & Delivery (CI/CD)

### ğŸš€ GitHub Actions Workflow

Use GitHub Actions as the primary CI/CD engine.  
Define workflows for:  
- **linting & formatting**
- **type checking**
- **unit & feature tests**
- **e2e/browser tests**
- **deployment**
- **semantic release automation**

Example pipeline stages:

.name: CI

on:
pull_request:
push:
branches: [main, release/*]

jobs:
lint:
runs-on: ubuntu-latest
steps:
- checkout
- setup node
- install deps
- run eslint & prettier checks

test:
runs-on: ubuntu-latest
strategy:
matrix:
php-version: [8.5]
node-version: [24.x]
steps:
- checkout
- setup php & composer
- setup node & npm
- install backend & frontend deps
- run backend tests (Pest)
- run frontend tests (Jest)
- run browser tests (Playwright)

release:
needs: test
runs-on: ubuntu-latest
steps:
- checkout
- setup node
- setup composer
- run semantic-release
env:
GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}

- Run lint and formatting checks before tests to stop invalid pushes early.  
- Matrix tests allow multiâ€‘environment validation.  
- Semantic release triggers only when all tests pass validating merges adhere to commit conventions. (CI/CD best practices)  [oai_citation:0â€¡CodeWithGillis](https://codewithgillis.com/building-enterprise-grade-frontend-applications-a-complete-guide-to-advanced-project-structure/)

---

## âš™ï¸ Code Quality & Tooling

### ğŸ§¹ Linting & Formatting

Use standardized tooling ecosystem:

ESLint + @eslint/js + typescript-eslint
Prettier + prettierâ€‘pluginâ€‘organizeâ€‘imports + prettierâ€‘pluginâ€‘tailwindcss
eslintâ€‘configâ€‘prettier

- ESLint enforces JS/TS best practices.
- Prettier ensures uniform formatting.
- Prettier plugins optimize Tailwind utilities and import ordering.
- Configured to run via **Husky preâ€‘commit hooks** to guarantee consistency on staging branches.  [oai_citation:1â€¡CodeWithGillis](https://codewithgillis.com/building-enterprise-grade-frontend-applications-a-complete-guide-to-advanced-project-structure/)

---

## ğŸª Preâ€‘Commit Hooks (Husky + Commitlint)

Husky hooks enforce local safety checks:

.pre-commit:
lint-staged:
- â€˜.ts?(x)â€™: eslint
- â€™.js?(x)â€™: eslint
- â€˜.jsonâ€™: prettier
- â€™.phpâ€™: laravel pint

Commit message standardization:

@commitlint/config-conventional

Commitlint ensures messages follow Conventional Commits spec, enabling automated semantic versioning and release changelog generation.  [oai_citation:2â€¡CodeWithGillis](https://codewithgillis.com/building-enterprise-grade-frontend-applications-a-complete-guide-to-advanced-project-structure/)

---

## ğŸ“¦ Automated Releases (semanticâ€‘release)

Use **semanticâ€‘release** to automate:

- Version bumping (semver)  
- Changelog generation (@semantic-release/changelog)  
- Git tagging & version commits (@semantic-release/git)  
- GitHub Releases (@semantic-release/github)

Rules driven by commit messages:

feat: minor bump
fix: patch bump
BREAKING CHANGE: major bump

Semantic release eliminates manual version updates and standardizes release artifacts.  [oai_citation:3â€¡CodeWithGillis](https://codewithgillis.com/building-enterprise-grade-frontend-applications-a-complete-guide-to-advanced-project-structure/)

---

## ğŸ§ª Testing Workflows

### ğŸ’¥ Backend Testing (Pest + PHPUnit)

Focus areas:

- Unit tests for services, actions, helpers  
- Feature tests for HTTP + Inertia responses  
- Policy/authorization tests
- Scout + Meilisearch indexing tests
- Localization routing & fallback tests
- Notification & broadcast behavior

Example backend scenario:

test(â€˜localized homepage returns correct propsâ€™, function () {
$this->get(â€™/enâ€™)->assertInertia(fn($page) => $page->where(â€˜localeâ€™,â€˜enâ€™));
});

Pest improves readable tests and integrates with Laravel seamlessly.  [oai_citation:4â€¡Reddit](https://www.reddit.com/r/laravel/comments/1b73mv3)

---

### ğŸ§  Frontend Testing

#### ğŸ§© Unit & Component Tests

Use **Jest + React Testing Library**:

- Test isolated React components
- Mock Zustand stores + i18next
- Validate UI behavior and accessibility

Examples:

test(â€˜renders localized textâ€™, () => {
render();
expect(screen.getByText(/welcome/i)).toBeInTheDocument();
});

---

### ğŸŒ Endâ€‘toâ€‘End (Playwright)

Browser tests simulate real user flows including:

- Navigation
- Localization behavior
- Form interactions
- Authentication flows
- SSR hydration behavior

Use **pestâ€‘pluginâ€‘browser** to run E2E tests via PHP test suite for consistency. Tests can verify full stack flows in a CI environment.  [oai_citation:5â€¡Reddit](https://www.reddit.com/r/laravel/comments/1j052ij)

---

## ğŸ“ˆ Deployment & Infrastructure

### Dockerized Deployment

Use multiâ€‘stage Docker builds:

FROM composer as vendor
COPY composer.json composer.lock ./
RUN composer install â€“no-dev

FROM node as frontend
COPY package.json package-lock.json ./
RUN npm install

FROM laravel/app
COPY . .
COPY â€“from=vendor /vendor ./vendor
COPY â€“from=frontend /node_modules ./node_modules
RUN npm run build

CMD [â€œphp-fpmâ€]

Add web server (Nginx) config for SSR and Inertia routing.

---

## ğŸª™ Performance & Monitoring

Integrate:

- Application performance monitoring (Sentry, Datadog)
- Realâ€‘time metrics (Prometheus, Grafana)
- Logging & observability (ELK, Seq)
- Health checks & uptime monitoring

---

## ğŸ“Œ Summary (DevOps, Testing & CI/CD)

| Concern | Tooling / Strategy |
|---------|------------------|
| Linting | ESLint + Prettier |
| Formatting | Prettier + Tailwind Plugin |
| Commit Quality | Husky + Commitlint |
| Automated Releases | semanticâ€‘release |
| Backend Tests | Pest + PHPUnit |
| Frontend Tests | Jest + RTL |
| Browser E2E | Playwright |
| CI/CD | GitHub Actions Matrix |
| Dockerization | Multiâ€‘stage images |
| Monitoring | Sentry + Prometheus |

---